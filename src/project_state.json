{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 242,
  "summary": "Build a separate Maui Lane Care Home application by closely copying the Moritz Care Home application's layout, UI, and details, on the existing ICP canister (Motoko) + React (Vite) scaffold with Internet Identity.",
  "architectural_notes": [
    "Architecture: ICP canister app with Motoko backend + React (Vite) frontend.",
    "Authentication: Internet Identity used on the frontend; actor-based calls to backend canister.",
    "Authorization: Backend access-control module enforces permissions; frontend includes AccessDenied UX.",
    "UI stack: Tailwind CSS + shadcn-ui component library.",
    "Build/deploy: Includes Docker/deploy scripts and ICP config; image resize/prune scripts for generated assets.",
    "Frontend: Maui-specific app shell/navigation components (MauiAppShell/MauiNav) layered on the existing React+II scaffold.",
    "Frontend: Maui residents module built from composable components (ResidentGrid/Card/Header/KPIs/Tabs/FilterSort) with mock data + list utilities as a stand-in for backend integration.",
    "Frontend: Added Maui resident profile/detail page with supporting mock profile + medications data modules as a stand-in for backend detail endpoints.",
    "Build/template sync: Updated ICP + React/Vite + shadcn-ui build template/tooling and Motoko authorization modules to current component versions (core-infrastructure v1.0.2, authorization v4.0.0).",
    "Build/template sync: Refreshed build-template React (v1.0.0) + shadcn-ui (v1.0.0) + associated tooling/scripts to match current component versions across the repo."
  ],
  "known_issues": [
    "All discharged residents disappear from the Residents dashboard instead of remaining visible under the Discharged status/tab (expected to remain visible indefinitely).",
    "Production/backend connectivity error shown after deployment: \"Backend connection is not available. Please ensure you are logged in.\" (likely auth/actor/canister connectivity issue)."
  ],
  "isFixRequest": true,
  "generatedImages": [
    {
      "filename": "frontend/public/assets/generated/maui-lane-logo.photo.v3.dim_512x512.png",
      "description": "Generated Maui Lane logo photo variant v3 (512x512).",
      "targetWidth": 512,
      "targetHeight": 512
    }
  ],
  "existing_features": [
    {
      "id": "IF-1",
      "title": "Motoko backend canister scaffold",
      "synonyms": [
        "core infrastructure",
        "backend main canister"
      ],
      "description": "Backend canister structure with main entrypoint and supporting modules wired for the application.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "Authorization & access control (Motoko)",
      "synonyms": [
        "mixin authorization",
        "access-control"
      ],
      "description": "Backend authorization layer implementing access control logic for protected operations.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "React (Vite) frontend scaffold with app layout",
      "synonyms": [
        "initial app UI",
        "AppLayout",
        "ScreenContainer"
      ],
      "description": "Frontend application shell including layout, navigation structure, shared loading/error states, and Tailwind styling.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Internet Identity authentication integration",
      "synonyms": [
        "II auth",
        "useInternetIdentity",
        "login button"
      ],
      "description": "Frontend authentication hooks and UI for Internet Identity login and session handling; actor wiring to backend.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "Protected-access UX (Access Denied screen)",
      "synonyms": [
        "AccessDeniedScreen"
      ],
      "description": "Frontend handling for unauthorized access scenarios with a dedicated access denied screen.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Profile setup modal",
      "synonyms": [
        "ProfileSetupModal",
        "onboarding"
      ],
      "description": "Frontend modal flow to guide users through initial profile setup after authentication.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Core application pages",
      "synonyms": [
        "HomePage",
        "AnnouncementsPage",
        "FacilitiesPage",
        "ResidentsPage",
        "ProfilePage"
      ],
      "description": "Implemented initial route pages for core sections of the app (home, announcements, facilities, residents, profile).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Generated brand assets (icon, logo, hero)",
      "synonyms": [
        "generated images",
        "branding assets"
      ],
      "description": "Generated static PNG assets for app icon, logo, and hero banner included in the frontend public assets.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "Build/deploy template and tooling",
      "synonyms": [
        "Dockerfile",
        "deploy.sh",
        "icp.yaml",
        "build template"
      ],
      "description": "Project build template including Docker/deploy scripts, ICP configuration, and frontend build tooling/scripts (e.g., image processing).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "Shadcn UI component library included",
      "synonyms": [
        "shadcn-ui"
      ],
      "description": "Shadcn UI component set added to the frontend codebase for consistent UI primitives.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-11",
      "title": "Maui Lane Care Home branded app shell + navigation",
      "synonyms": [
        "MauiAppShell",
        "MauiNav",
        "branded layout"
      ],
      "description": "Introduced Maui-specific application shell and navigation components and wired them into the React app, using the generated Maui Lane brand assets in the authenticated experience.",
      "reqIds": [
        "REQ-3",
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "IF-12",
      "title": "Moritz reference capture route + missing-reference placeholder",
      "synonyms": [
        "MoritzReferenceCapture",
        "MissingReferencePlaceholder",
        "reference inputs"
      ],
      "description": "Added a dedicated reference-capture page/route and a placeholder UI that documents what Moritz reference screenshots/pages are needed when references have not been provided.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "IF-13",
      "title": "Maui dashboard page (authenticated)",
      "synonyms": [
        "Dashboard",
        "maui pages"
      ],
      "description": "Added an initial Maui-specific dashboard page under the Maui route set, intended to mirror the Moritz app structure within the protected/authenticated experience.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-14",
      "title": "Maui residents directory UI (dashboard/grid with filtering + KPIs)",
      "synonyms": [
        "Maui residents page",
        "ResidentGrid",
        "ResidentCard",
        "ResidentStatusTabs",
        "ResidentFilterSortBar"
      ],
      "description": "Implemented Maui-specific residents UI components including a resident dashboard header, KPI row, status tabs, filter/sort bar, and responsive resident card/grid rendering backed by mock resident data and list utilities.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-15",
      "title": "Maui resident profile page (detail view) with mock profile + medications data",
      "synonyms": [
        "ResidentProfile",
        "resident detail page",
        "mockResidentProfileData",
        "mockResidentMedications"
      ],
      "description": "Added a Maui-specific resident profile/detail page with supporting mock profile and medication datasets to complement the residents directory and enable navigation to an individual resident view prior to backend integration.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-16",
      "title": "Maui residents add/edit resident dialogs (UI-only, mock wiring)",
      "synonyms": [
        "AddNewResidentDialog",
        "EditResidentInformationDialog",
        "resident CRUD dialogs"
      ],
      "description": "Added Maui residents module dialogs for adding a new resident and editing resident information, matching the intended Moritz-style UI patterns; currently frontend-only with mock/non-persistent behavior pending backend integration.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-17",
      "title": "Maui resident profile print report page",
      "synonyms": [
        "ResidentProfilePrintReport",
        "printable resident report",
        "resident report print view"
      ],
      "description": "Added a dedicated Maui resident profile print-report page/component to render a printable version of resident details (intended for printing/export) alongside the existing resident profile detail experience.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-18",
      "title": "Maui resident vitals UI (record daily vitals + vitals history list)",
      "synonyms": [
        "RecordDailyVitalsDialog",
        "VitalsHistoryList",
        "resident vitals module"
      ],
      "description": "Added Maui residents vitals UI components to support recording daily vitals via a dialog and viewing prior vitals entries in a history list; currently frontend-only pending backend persistence/integration.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-19",
      "title": "MAR (Medication Administration Record) UI in resident profile (tab + add-record modal + history list)",
      "synonyms": [
        "MAR tab",
        "AddMarRecordDialog",
        "MarHistoryList"
      ],
      "description": "Implemented functional MAR module UI within the Maui resident profile, including a MAR history list view and an \"Add MAR Record\" button that opens a modal for creating a MAR entry.",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "IF-20",
      "title": "Frontend MAR data flow via React Query hooks (create/list/delete)",
      "synonyms": [
        "React Query MAR hooks",
        "MAR mutations/queries"
      ],
      "description": "Added frontend query/mutation wiring for MAR records using React Query-style hooks to create, list, and delete MAR records and refresh the MAR list after mutations.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "IF-21",
      "title": "Motoko backend MAR record persistence (types + CRUD with access control)",
      "synonyms": [
        "MAR canister methods",
        "MAR list/create/delete"
      ],
      "description": "Extended the Motoko backend canister with MAR record types and CRUD endpoints (list/create/delete), enforcing access control consistent with the existing authorization module.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "IF-22",
      "title": "ADL (Activities of Daily Living) UI in resident profile (add-record dialog + history list)",
      "synonyms": [
        "ADL tab",
        "AddAdlRecordDialog",
        "AdlHistoryList"
      ],
      "description": "Added Maui residents ADL UI components to support recording ADL entries via a dialog and viewing prior ADL entries in a history list; currently frontend-only pending backend persistence/integration.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-23",
      "title": "Resident medications UI (add-medication dialog components)",
      "synonyms": [
        "AddMedicationDialog",
        "resident medications module UI"
      ],
      "description": "Added Maui residents medications UI components (e.g., AddMedicationDialog and medications module index) to support adding/managing medication entries in the resident profile experience; frontend/UI-layer only pending backend persistence/integration.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-24",
      "title": "Motoko backend resident persistence (types + CRUD with access control)",
      "synonyms": [
        "Residents canister methods",
        "resident list/create/update/delete",
        "resident status toggle"
      ],
      "description": "Extended the Motoko backend canister with resident data types and CRUD-style endpoints to create, list, update (including status toggle), and delete residents, enforcing access control consistent with the existing authorization module and supporting stable persistence/migration.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "IF-25",
      "title": "Frontend residents React Query hooks (list/create/delete/update) keyed by principal",
      "synonyms": [
        "residentQueryKeys",
        "React Query residents hooks",
        "principal-keyed queries"
      ],
      "description": "Added/extended frontend query/mutation hooks for residents APIs (list/create/delete/update/toggle) with query keys scoped to the authenticated principal to ensure correct refetching and isolation across identity changes.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "IF-26",
      "title": "Residents Directory wired to backend resident list + mutations (delete/status toggle)",
      "synonyms": [
        "residentDirectoryViewModel",
        "backend-backed Residents Dashboard",
        "remove mockResidents state"
      ],
      "description": "Updated the Maui Residents Directory UI to load residents from the canister (instead of mock/local initialization) and to use backend-backed mutations for deletion and status toggling, keeping UI state consistent across reloads and sign-in changes via refetching.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "IF-27",
      "title": "Shared-room bed assignment support (backend schema + add/edit dialogs + consistent room labels)",
      "synonyms": [
        "resident bed field",
        "shared room bed A/B",
        "room label formatting"
      ],
      "description": "Extended the Resident data model to include an optional bed assignment for Shared rooms (A/B only), exposed it through create/update APIs with migration support, updated Add New Resident and Edit Resident Information dialogs to conditionally show/clear the Bed selector based on Room Type, and updated resident room labels across directory/profile UI to display the bed letter for Shared rooms and omit it otherwise.",
      "reqIds": [
        "REQ-12",
        "REQ-13",
        "REQ-14",
        "REQ-15",
        "REQ-16",
        "REQ-17",
        "REQ-18",
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "IF-28",
      "title": "Global Maui Lane logo rendering fix (BrandLogo + asset path)",
      "synonyms": [
        "logo asset fix",
        "BrandLogo reliability"
      ],
      "description": "Updated brand logo component/asset wiring so the Maui Lane logo renders reliably across authenticated application pages (addresses prior missing-logo issue).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-29",
      "title": "Resident deletion consistency across sign-in (principal-scoped storage + refetch/invalidation)",
      "synonyms": [
        "deleted residents no longer reappear after login",
        "principal-scoped resident persistence fix"
      ],
      "description": "Adjusted backend resident persistence/access-control and frontend resident query keying/refetch behavior to ensure residents deleted under a given Internet Identity principal do not reappear after a subsequent sign-in, addressing principal-scoped query/refetch and persistence consistency.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-30",
      "title": "Maui Lane logo replaced with provided MauiLaneCareHome image and applied globally",
      "synonyms": [
        "replace logo everywhere",
        "global logo asset update",
        "MauiLaneCareHome.jpg wiring"
      ],
      "description": "Updated the frontend brand/logo asset and wiring (e.g., BrandLogo usage and public assets/manifest references) so the provided Maui Lane Care Home logo image is used consistently across the app in all contexts/pages.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-31",
      "title": "Residents dashboard v47 regression fixed (restored v46 loading behavior)",
      "synonyms": [
        "rollback to v46",
        "residents dashboard loads again",
        "production regression fix"
      ],
      "description": "Applied changes to restore the Residents dashboard loading behavior consistent with v46 (addressing the v47 regression where residents failed to load with an immediate error). Includes supporting rollback documentation for returning to v46 if needed.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-the-existing-edit-resident-information-dialog-to-support-editing-the-resident-s-responsible-persons-add-and-edit-entries-and-allow-removing-an-entry-in-addition-to-the-existing-physicians-and-pharmacy-sections",
      "title": "Extend the existing “Edit Resident Information” dialog to support editing the resident’s Responsible Persons (add and edit entries, and allow removing an entry) in addition to the existing Physicians and Pharmacy sections.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-resident-profile-save-changes-flow-so-updates-from-the-edit-resident-information-dialog-persist-responsible-persons-physicians-and-pharmacy-changes-to-the-backend-using-the-existing-updateresident-mutation",
      "title": "Wire the Resident Profile “Save Changes” flow so updates from the Edit Resident Information dialog persist Responsible Persons, Physicians, and Pharmacy changes to the backend using the existing updateResident mutation.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-resident-profile-ui-to-display-the-resident-s-age-beside-the-existing-date-of-birth-value-in-the-basic-information-card",
      "title": "Update the Resident Profile UI to display the resident’s age beside the existing “Date of Birth” value in the Basic Information card.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-resident-profile-print-report-view-to-include-the-resident-s-age-along-with-date-of-birth-in-the-resident-information-section",
      "title": "Update the Resident Profile print/report view to include the resident’s age along with Date of Birth in the Resident Information section.",
      "reqIds": [
        "REQ-26"
      ],
      "version": 1
    },
    {
      "id": "feature-make-frontend-actor-creation-resilient-in-useactor-handle-failures-from-actor-creation-and-access-control-initialization-so-the-ui-can-present-a-clear-backend-connectivity-auth-error-state-instead-of-silently-leaving-actor-as-null",
      "title": "Make frontend actor creation resilient: in `useActor`, handle failures from actor creation and access-control initialization so the UI can present a clear backend connectivity/auth error state instead of silently leaving `actor` as null.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-lightweight-frontend-diagnostic-path-that-uses-the-backend-healthcheck-to-distinguish-canister-unreachable-from-authenticated-but-not-authorized-initialized-and-incorporate-that-into-the-existing-error-ui-shown-on-the-dashboard-when-backend-calls-fail",
      "title": "Add a lightweight frontend diagnostic path that uses the backend `healthCheck()` to distinguish 'canister unreachable' from 'authenticated but not authorized/initialized', and incorporate that into the existing error UI shown on the Dashboard when backend calls fail.",
      "reqIds": [
        "REQ-30"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Recreate an exact copy of the Moritz Care Home application (layout, UI, and details) as a separate application branded for Maui Lane Care Home.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Create a separate application experience branded as “Maui Lane Care Home” that closely recreates the Moritz Care Home application’s layout, UI, and on-screen details, using the existing React + Motoko + Internet Identity template as the foundation.",
      "reqIds": [
        "REQ-1"
      ],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Ensure any Moritz-specific data labels, placeholders, and UI copy are replaced with Maui Lane Care Home equivalents while keeping the same UI structure as the Moritz reference.",
      "reqIds": [
        "REQ-4"
      ],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Maintain compatibility with existing Internet Identity authentication and protected-access UX (do not remove or bypass login gating); the Maui Lane Care Home UI should appear within the authenticated experience where applicable.",
      "reqIds": [
        "REQ-5"
      ],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Show sample resident profiles with complete information in the Residents dashboard (seed/demo data) that can be edited later.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Seed 3 editable sample resident profiles (complete data across all supported fields/modules) and show them by default for all staff users/accounts in the Residents dashboard.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Enable editing resident information to include Physician, Pharmacy, and Responsible Persons fields/sections.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-10",
      "summary": "Fix backend access-control initialization so the frontend can always create an authenticated actor after Internet Identity login, without trapping when `_initializeAccessControlWithSecret` is called with an empty or missing `caffeineAdminToken` URL parameter.",
      "reqIds": [
        "REQ-22"
      ],
      "status": "pending"
    },
    {
      "id": "AR-11",
      "summary": "Ensure authenticated callers are able to use core backend APIs (profile + residents + vitals/MAR/ADL) immediately after login by guaranteeing they have the required baseline permission/role (e.g., `#user`) even when no admin secret is provided.",
      "reqIds": [
        "REQ-23"
      ],
      "status": "pending"
    },
    {
      "id": "AR-12",
      "summary": "Add a lightweight backend health-check query method that does not require authentication/permissions and returns a simple success payload for diagnosing canister connectivity in production.",
      "reqIds": [
        "REQ-24"
      ],
      "status": "pending"
    },
    {
      "id": "AR-13",
      "summary": "Display the resident’s age in the Resident Profile UI beside Date of Birth, and also include age in the Resident Profile print/report view.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-14",
      "summary": "Update backend access-control initialization so an authenticated user can create and use an authenticated actor immediately after Internet Identity login even when the `caffeineAdminToken` URL parameter is missing/empty, without trapping during `_initializeAccessControlWithSecret`.",
      "reqIds": [
        "REQ-27"
      ],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Ensure the backend provides a reliable unauthenticated health-check query and that its payload fields are accurate (e.g., `canisterId` should reflect the backend canister’s principal, not the caller).",
      "reqIds": [
        "REQ-29"
      ],
      "status": "pending"
    }
  ],
  "projectName": "Recreate Moritz Care Home UI as a separate Maui Lane Care Home application",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}